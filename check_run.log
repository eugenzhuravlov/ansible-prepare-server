klevo@DESKTOP-RNLB524:~/ansible-prepare-server$ ansible-playbook -i inventory/hosts playbooks/prepare_server.yml --check
[WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details

PLAY [Prepare CPU-related configurations on dev-cpu hosts] ******************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [cpu : Include C-states tasks for all CPUs] ****************************************************************************************************************************************************************
included: /home/klevo/ansible-prepare-server/roles/cpu/tasks/disable_cstate.yml for 63.176.213.67

TASK [cpu : Disable C-states for all CPUs] **********************************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [cpu : Include performance mode tasks using cpupower] ******************************************************************************************************************************************************
included: /home/klevo/ansible-prepare-server/roles/cpu/tasks/cpupower.yml for 63.176.213.67

TASK [cpu : Check if cpupower tool is installed] ****************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [cpu : Install cpupower tool] ******************************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Set CPU governor to performance using cpupower] *****************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Verify CPU governor using cpupower] *****************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [cpu : Check if cpupower service exists] *******************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Skip restart if cpupower service is not found] ******************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Configure cpupower governor setting] ****************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Include performance mode tasks using cpufrequtils] **************************************************************************************************************************************************
included: /home/klevo/ansible-prepare-server/roles/cpu/tasks/cpufrequtils.yml for 63.176.213.67

TASK [cpu : Install cpufrequtils tool] **************************************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [cpu : Check if CPU scaling governor files exist] **********************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [cpu : Skip tasks if CPU scaling governor is not supported] ************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": "CPU scaling governor is not supported on this system."
}

TASK [cpu : Ensure CPU frequency governor is set to performance] ************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Verify CPU governor settings] ***********************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Debug governor status] ******************************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Check if cpufrequtils service exists] ***************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Skip restart if cpufrequtils service is not found] **************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [cpu : Persist performance mode in cpufrequtils] ***********************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [Display information about CPUs and Hyper-Threading] *******************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": "1 cores, Hyper-Threading: disabled"
}

RUNNING HANDLER [cpu : Update GRUB] *****************************************************************************************************************************************************************************
skipping: [63.176.213.67]

PLAY [Encrypt disks on dev-encrypt hosts] ***********************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Validate disk existence] ************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Fail if disk does not exist] ********************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Include encryption tasks] ***********************************************************************************************************************************************************
included: /home/klevo/ansible-prepare-server/roles/encrypt_second_disk/tasks/encrypt.yml for 63.176.213.67

TASK [encrypt_second_disk : Install cryptsetup for disk encryption] *********************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Check if disk exists] ***************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Fail if disk does not exist] ********************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Check if the disk has partitions] ***************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Partition the disk if no partitions exist] ******************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Wait for the kernel to recognize the new partition] *********************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Check if partition exists] **********************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Fail if partition does not exist] ***************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Check if the partition is already encrypted] ****************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Debug luks_check output] ************************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": "cryptsetup isLuks result: 0"
}

TASK [encrypt_second_disk : Encrypt the partition] **************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Open the encrypted partition] *******************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Verify the encrypted partition is available] ****************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_second_disk : Fail if encrypted partition is not available] ***************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_second_disk : Create a filesystem on the encrypted partition] *************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_second_disk : Create mount directory] *************************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_second_disk : Mount the encrypted partition] ******************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_second_disk : Add the encrypted partition to /etc/crypttab] ***************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_second_disk : Add the mount to /etc/fstab] ********************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_next_partition : Get the root partition] **********************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Set default root partition if undefined] *****************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Debug root partition] ************************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": "Root partition is /dev/xvda1"
}

TASK [encrypt_next_partition : Extract the disk from the root partition] ****************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Identify the next partition after root] ******************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Debug next partition] ************************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": "Next partition after root is /dev/xvda14"
}

TASK [encrypt_next_partition : Include encryption tasks] ********************************************************************************************************************************************************
included: /home/klevo/ansible-prepare-server/roles/encrypt_next_partition/tasks/encrypt_next_partition.yml for 63.176.213.67

TASK [encrypt_next_partition : Check if the partition exists] ***************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Fail if the partition does not exist] ********************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Check if the partition is already encrypted] *************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Check if the partition is mounted] ***********************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Fail if the partition is already mounted] ****************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Encrypt the partition] ***********************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Open the encrypted partition] ****************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Verify the encrypted partition is available] *************************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Simulate encrypted partition existence in check mode] ****************************************************************************************************************************
ok: [63.176.213.67]

TASK [encrypt_next_partition : Fail if the encrypted partition is not available] ********************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Create a filesystem on the encrypted partition] **********************************************************************************************************************************
skipping: [63.176.213.67]

TASK [encrypt_next_partition : Create mount directory] **********************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_next_partition : Mount the encrypted partition] ***************************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_next_partition : Add the encrypted partition to /etc/crypttab] ************************************************************************************************************************************
changed: [63.176.213.67]

TASK [encrypt_next_partition : Add the mount to /etc/fstab] *****************************************************************************************************************************************************
changed: [63.176.213.67]

PLAY [Configure network settings on dev-network hosts] **********************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [network : Gather facts about active network interfaces] ***************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [network : Identify the active network interface] **********************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [network : Check if the interface is already named net0] ***************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Check if /etc/netplan/ contains net0 configuration] *********************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Skip renaming if net0 is already in /etc/netplan] ***********************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Display facts about the current interface] ******************************************************************************************************************************************************
ok: [63.176.213.67] => {
    "msg": [
        "Current interface name: enX0",
        "IPv4 Address: 172.30.39.59",
        "MAC Address: 02:75:aa:0e:1f:af",
        "MTU: 9001"
    ]
}

TASK [network : Schedule a reboot in 60 seconds] ****************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Rename network interface to net0] ***************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Bring up the renamed interface] *****************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Retrieve updated facts after renaming] **********************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [network : Display facts about the renamed interface] ******************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Find the netplan file responsible for network configuration] ************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Update netplan configuration to rename interface] ***********************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Apply netplan changes] **************************************************************************************************************************************************************************
skipping: [63.176.213.67]

TASK [network : Cancel the scheduled reboot] ********************************************************************************************************************************************************************
skipping: [63.176.213.67]

PLAY [Gather server configuration] ******************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************
ok: [63.176.213.67]

TASK [Gather facts about the server] ****************************************************************************************************************************************************************************
ok: [63.176.213.67]

PLAY RECAP ******************************************************************************************************************************************************************************************************
63.176.213.67              : ok=48   changed=11   unreachable=0    failed=0    skipped=38   rescued=0    ignored=0
